# ğŸ“· Intel RealSense D435i í†µí•©

Unitree G1 (Jetson Orin NX)ì—ì„œ ì‹¤ì‹œê°„ RGB-D ì¹´ë©”ë¼ ìŠ¤íŠ¸ë¦¬ë°

---

## ğŸ“‹ í”„ë¡œì íŠ¸ ëª©í‘œ

Jetsonì˜ RealSense D435iì—ì„œ RGB + Depth ìº¡ì²˜ â†’ UDPë¡œ Macì— ìŠ¤íŠ¸ë¦¬ë° â†’ ì‹¤ì‹œê°„ í‘œì‹œ

LiDAR ë·°ì–´ì™€ ë™ì¼í•œ íŒ¨í„´: ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ì„ ìœ„í•œ ê°„ë‹¨í•œ UDP/Pickle ë°©ì‹

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
RealSense/
â”œâ”€â”€ check_camera.py              âœ… ì¹´ë©”ë¼ ê°ì§€ ë° í™•ì¸
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ 01_basic_capture.py      ğŸ“ ë¡œì»¬ í…ŒìŠ¤íŠ¸ (í”„ë ˆì„ ìº¡ì²˜ë§Œ)
â”‚   â”œâ”€â”€ 02_stream_sender.py      ğŸ“ Jetson â†’ Mac ì†¡ì‹ 
â”‚   â””â”€â”€ 03_stream_receiver.py    ğŸ“ Mac ìˆ˜ì‹  ë° í‘œì‹œ
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ config.py                ğŸ“ ê³µí†µ ì„¤ì •
â””â”€â”€ README.md                    ğŸ“ ì´ íŒŒì¼
```

---

## ğŸ”„ ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Jetson (ë¡œë´‡)                                            â”‚
â”‚                                                         â”‚
â”‚  RealSense D435i                                        â”‚
â”‚     â”œâ”€ RGB (640x480 BGR) â”€â”€â”                           â”‚
â”‚     â””â”€ Depth (640x480 mm)  â”‚                           â”‚
â”‚                            â–¼                            â”‚
â”‚  02_stream_sender.py                                    â”‚
â”‚     â”œâ”€ NumPy array                                      â”‚
â”‚     â”œâ”€ Pickle ì§ë ¬í™”                                     â”‚
â”‚     â””â”€ UDP socket â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                            â”‚
                                                            â”‚ UDP 8889 (RGB)
                                                            â”‚ UDP 8890 (Depth)
                                                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ Mac (ì§€ìƒêµ­)                                             â”‚ â”‚
â”‚                                                         â”‚ â”‚
â”‚  03_stream_receiver.py                                  â”‚ â”‚
â”‚     â”œâ”€ UDP socket â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚     â”œâ”€ Pickle ì—­ì§ë ¬í™”
â”‚     â”œâ”€ NumPy array
â”‚     â””â”€ OpenCV í‘œì‹œ
â”‚         â”œâ”€ RGB ì°½
â”‚         â””â”€ Depth (ì»¬ëŸ¬ë§µ) ì°½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ êµ¬í˜„ ë‹¨ê³„

### Phase 1: ë¡œì»¬ í…ŒìŠ¤íŠ¸ (Jetsonë§Œ)

**01_basic_capture.py**
- RealSenseì—ì„œ í”„ë ˆì„ ìº¡ì²˜
- NumPy ë°°ì—´ë¡œ ë³€í™˜
- íŒŒì¼ë¡œ ì €ì¥í•˜ì—¬ í™•ì¸
- ì¹´ë©”ë¼ ì ‘ê·¼ í™•ì¸ìš©

**ëª©ì :** ì¹´ë©”ë¼ ê¸°ëŠ¥ í™•ì¸

---

### Phase 2: ë„¤íŠ¸ì›Œí¬ ì „ì†¡ (Jetson)

**02_stream_sender.py** (vibes ì°¸ê³ )
- RealSense ì´ˆê¸°í™”
- RGB + Depth ìº¡ì²˜
- Pickleë¡œ ì§ë ¬í™”
- UDPë¡œ Macì— ì „ì†¡
- ê°„ë‹¨í•œ ë°©ì‹ (GStreamer ì—†ì´)

**ì¥ì :**
- LiDAR ë·°ì–´ì™€ ë™ì¼í•œ íŒ¨í„´
- ê°„ë‹¨í•œ êµ¬í˜„
- ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘

**ì œì•½ì‚¬í•­:**
- ë†’ì€ ëŒ€ì—­í­ (ì••ì¶• ì—†ìŒ)
- í•´ìƒë„ ì œí•œ (640x480 ê¶Œì¥)

---

### Phase 3: ìˆ˜ì‹  ë° í‘œì‹œ (Mac)

**03_stream_receiver.py** (LiDAR ë·°ì–´ ìœ ì‚¬)
- UDP íŒ¨í‚· ìˆ˜ì‹ 
- Pickle ë°ì´í„° ì—­ì§ë ¬í™”
- OpenCVë¡œ í‘œì‹œ
  - RGB ì°½
  - Depth ì»¬ëŸ¬ë§µ ì°½
- ì‹¤ì‹œê°„ FPS í‘œì‹œ

---

## âš™ï¸ ì„¤ì •

```python
# utils/config.py
class RealSenseConfig:
    # í•´ìƒë„
    WIDTH = 640
    HEIGHT = 480
    FPS = 30

    # ë„¤íŠ¸ì›Œí¬
    MAC_IP = "10.40.100.105"  # Mac IP (LiDARì²˜ëŸ¼)
    RGB_PORT = 8889
    DEPTH_PORT = 8890

    # Depth ì„¤ì •
    DEPTH_MIN = 0      # mm
    DEPTH_MAX = 6000   # mm (6m)
```

---

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ì‚¬ì „ ì¤€ë¹„

**Jetson (ë¡œë´‡):**
```bash
pip3 install pyrealsense2 numpy opencv-python
```

**Mac (ì§€ìƒêµ­):**
```bash
pip3 install numpy opencv-python
```

### ì‹¤í–‰

**1. ì¹´ë©”ë¼ ì—°ê²° í™•ì¸ (Jetson):**
```bash
cd /home/unitree/AIM-Robotics/RealSense
python3 check_camera.py
```

**2. ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘ (Jetson):**
```bash
cd /home/unitree/AIM-Robotics/RealSense/examples
python3 02_stream_sender.py 10.40.100.105
```

**3. ìˆ˜ì‹  ë° í‘œì‹œ (Mac):**
```bash
python3 03_stream_receiver.py
```

---

## ğŸ¨ Depth ì‹œê°í™”

Depthë¥¼ ì»¬ëŸ¬ë§µìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì‹œê°í™”:

```python
import cv2
import numpy as np

depth_colormap = cv2.applyColorMap(
    cv2.convertScaleAbs(depth_image, alpha=0.03),
    cv2.COLORMAP_JET
)
```

**ìƒ‰ìƒ ì˜ë¯¸:**
- ğŸ”µ íŒŒë‘: ê°€ê¹Œì›€ (0-1m)
- ğŸŸ¢ ì´ˆë¡: ì¤‘ê°„ (1-3m)
- ğŸ”´ ë¹¨ê°•: ë©€ë¦¬ (3-6m)

---

## ğŸ“Š vibesì™€ ë¹„êµ

| í•­ëª© | vibes | ìš°ë¦¬ ë°©ì‹ |
|------|-------|----------|
| ì¸ì½”ë”© | H.264 (HW) | Raw (Pickle) |
| í”„ë¡œí† ì½œ | GStreamer/RTP | UDP/Pickle |
| ë³µì¡ë„ | ë†’ìŒ | ë‚®ìŒ |
| ëŒ€ì—­í­ | ë‚®ìŒ (4Mbps) | ë†’ìŒ (~30Mbps) |
| ì§€ì—° | ~30ms | ~50ms |
| êµ¬í˜„ ë‚œì´ë„ | ì–´ë ¤ì›€ | ì‰¬ì›€ |

**ì „ëµ:** UDP/Pickleë¡œ ê°„ë‹¨í•˜ê²Œ ì‹œì‘ â†’ í•„ìš”ì‹œ ë‚˜ì¤‘ì— GStreamer ì¶”ê°€

---

## ğŸ“· ì¹´ë©”ë¼ ì •ë³´

**ê°ì§€ëœ ë””ë°”ì´ìŠ¤:**
```
ì´ë¦„:           Intel RealSense D435I
ì‹œë¦¬ì–¼ ë²ˆí˜¸:    335522070701
íŒì›¨ì–´:         5.13.0.55
USB íƒ€ì…:       3.2 (USB 3.1)
```

**ì‚¬ìš© ê°€ëŠ¥í•œ ì„¼ì„œ:**
- âœ… Stereo Module (Depth ì„¼ì„œ)
- âœ… RGB Camera (ì»¬ëŸ¬ ì´ë¯¸ì§€)
- âœ… Motion Module (IMU - ìì´ë¡œ/ê°€ì†ë„ê³„)

**í…ŒìŠ¤íŠ¸ëœ ìŠ¤íŠ¸ë¦¼:**
- âœ… Depth: 640x480 @ 30fps (16-bit, ë°€ë¦¬ë¯¸í„°)
- âœ… Color: 640x480 @ 30fps (8-bit BGR)

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ì¹´ë©”ë¼ê°€ ê°ì§€ë˜ì§€ ì•ŠìŒ

```bash
# USB ì—°ê²° í™•ì¸
lsusb | grep -i intel
# ê²°ê³¼: 8086:0b3a Intel Corp. RealSense ê°€ ë³´ì—¬ì•¼ í•¨

# ì¹´ë©”ë¼ ì ‘ê·¼ í™•ì¸
python3 check_camera.py
```

### "Device or Resource Busy" ì—ëŸ¬

```bash
# USB ì¼€ì´ë¸” ì¬ì—°ê²°
# ë˜ëŠ” ì¹´ë©”ë¼ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
pkill -9 python3
```

### ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ

```bash
# Mac IP í™•ì¸
ifconfig | grep "inet " | grep -v 127.0.0.1

# UDP ì—°ê²° í…ŒìŠ¤íŠ¸
# Macì—ì„œ:
nc -ul 8889

# Jetsonì—ì„œ:
echo "test" | nc -u 10.40.100.105 8889
```

---

## ğŸ¯ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ì¹´ë©”ë¼ ê°ì§€ ìŠ¤í¬ë¦½íŠ¸ (check_camera.py)
- [x] USB 3.2 ì—°ê²° í™•ì¸
- [x] í”„ë¡œì íŠ¸ êµ¬ì¡° ê³„íš
- [ ] 01_basic_capture.py ì‘ì„±
- [ ] ë¡œì»¬ í”„ë ˆì„ ìº¡ì²˜ í…ŒìŠ¤íŠ¸
- [ ] 02_stream_sender.py ì‘ì„±
- [ ] 03_stream_receiver.py ì‘ì„±
- [ ] ë„¤íŠ¸ì›Œí¬ ìŠ¤íŠ¸ë¦¬ë° í…ŒìŠ¤íŠ¸
- [ ] ë¬¸ì„œ ì‘ì„± ì™„ë£Œ

---

## ğŸ“š ì°¸ê³  ìë£Œ

**vibes í”„ë¡œì íŠ¸:**
- `/home/unitree/unitree_g1_vibes/stream_realsense.py` - í’€ ê¸°ëŠ¥ ë¡œì»¬ ë·°ì–´
- `/home/unitree/unitree_g1_vibes/jetson_realsense_stream.py` - í”„ë¡œë•ì…˜ ìŠ¤íŠ¸ë¦¬ë°
- `/home/unitree/unitree_g1_vibes/receive_realsense_gst.py` - GStreamer ìˆ˜ì‹ ê¸°

**librealsense ì˜ˆì œ:**
- `/home/unitree/unitree_g1_vibes/librealsense/wrappers/python/examples/`

---

Made with ğŸ’¡ by AIM Robotics
